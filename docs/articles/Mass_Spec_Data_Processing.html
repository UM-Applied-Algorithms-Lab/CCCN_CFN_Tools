<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Mass Spectrometry Pre-Processing Guide â€¢ cccn.cfn.tools</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Mass Spectrometry Pre-Processing Guide">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cccn.cfn.tools</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Mass_Spec_Data_Processing.html">Mass Spectrometry Pre-Processing Guide</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Mass Spectrometry Pre-Processing Guide</h1>
                        <h4 data-toc-skip class="author">Nagashree A,
McKayl Bailey</h4>
            
      

      <div class="d-none name"><code>Mass_Spec_Data_Processing.Rmd</code></div>
    </div>

    
    
<p>This is a step-by-step guide on using the first twelve functions of
the CCCN CFN Tools package. First, there are brief descriptions of each
function, followed by an in depth look at actually running them. Please
note that certain parts of this can take up to an hour to run.</p>
<p>(Potential Notes here about needed hardware and OS requirements.
Function names can also be changed as needed.)</p>
<div class="section level2">
<h2 id="function-descriptions">Function Descriptions<a class="anchor" aria-label="anchor" href="#function-descriptions"></a>
</h2>
<div class="section level4">
<h4 id="spearman-dissimilarity">Spearman Dissimilarity:<a class="anchor" aria-label="anchor" href="#spearman-dissimilarity"></a>
</h4>
<p>This function takes a data frame, converts its values to numeric, and
computes the Spearman correlation matrix from the transposed data using
pairwise completion to handle missing values. It then calculates the
dissimilarity by subtracting the absolute values of the correlation
matrix from one. Any remaining missing values are replaced with the
maximum dissimilarity. Finally, it uses t-SNE, a method that reduces the
dimensions of the data to 3D while preserving its structure, to make it
easier to visualize and explore the data. The function returns the 3D
coordinates for plotting.</p>
</div>
<div class="section level4">
<h4 id="euclidean-distance">Euclidean Distance:<a class="anchor" aria-label="anchor" href="#euclidean-distance"></a>
</h4>
<p>This function takes a data frame, computes the Euclidean distance
matrix, and normalizes it by scaling distances to a range of 0 to 100.
It handles missing values by replacing them with a value 100 times the
maximum distance. It then also uses t-SNE to return 3D coordinates.</p>
</div>
<div class="section level4">
<h4 id="combined-parallel">Combined Parallel:<a class="anchor" aria-label="anchor" href="#combined-parallel"></a>
</h4>
<p>A utility function that runs both Euclidean Distance and Spearman
Dissimilarity at the same time. With each one on their own CPU core.
This is the most common way to actually call these functions, and is
aimed at reducing the run time, and the need for redundant function
calls. This function also finds the average between the two lists for
use later on.</p>
</div>
<div class="section level4">
<h4 id="make-cluster-list">Make Cluster List:<a class="anchor" aria-label="anchor" href="#make-cluster-list"></a>
</h4>
<p>Performs clustering analysis on t-SNE data. It takes your coordinate
data, an argument for cluster closeness, and a table with the original
gene labels as arguments. It then calculates a spanning tree based on
the distances in the t-SNE data and identifies clusters by computing
connected components with the specified threshold. Finally, it returns a
list of data frames, each containing the genes assigned to a specific
cluster.</p>
</div>
<div class="section level4">
<h4 id="find-common-clusters">Find Common Clusters:<a class="anchor" aria-label="anchor" href="#find-common-clusters"></a>
</h4>
<p>Takes the three arguments from the Combined Parallel Function
(Euclidean, Spearman, and average), and uses Make Cluster List to print
out an actual graph.</p>
</div>
<div class="section level4">
<h4 id="list-common-cluster">List Common Cluster:<a class="anchor" aria-label="anchor" href="#list-common-cluster"></a>
</h4>
<p>This looks for actual interactions and similarities between the new
clusters for each of the results. It returns a new list within the given
parameters.</p>
</div>
<div class="section level4">
<h4 id="generate-and-construct-ptms-network">Generate and Construct PTMs Network:<a class="anchor" aria-label="anchor" href="#generate-and-construct-ptms-network"></a>
</h4>
<p>The new cluster lists from above are used here to look for
Post-Translational Modifications. It then merges these separate data
frames for each cluster list into a single data frame. This function
also goes through and changes non-existent values from 0 to NA so that
they do not skew our results later on. There are also a number of
secondary functions inside of this that could be used for adapting your
own code.</p>
</div>
<div class="section level4">
<h4 id="make-adjecancy-matrix">Make Adjecancy Matrix:<a class="anchor" aria-label="anchor" href="#make-adjecancy-matrix"></a>
</h4>
<p>A fairly self explanatory function. This creates a matrix from your
chosen data sets by combining them.</p>
</div>
<div class="section level4">
<h4 id="bind-matricies">Bind Matricies:<a class="anchor" aria-label="anchor" href="#bind-matricies"></a>
</h4>
<p>Aligns the adjacency matrix with the correlation matrix. Then sets
diagonal connections to NA values.</p>
</div>
<div class="section level4">
<h4 id="correlation-network">Correlation Network:<a class="anchor" aria-label="anchor" href="#correlation-network"></a>
</h4>
<p>Turns the matrix created into an igraph object.</p>
</div>
<div class="section level4">
<h4 id="process-ptm-data">Process PTM Data:<a class="anchor" aria-label="anchor" href="#process-ptm-data"></a>
</h4>
</div>
<div class="section level4">
<h4 id="get-gene-names-from-peptides">Get Gene Names from Peptides:<a class="anchor" aria-label="anchor" href="#get-gene-names-from-peptides"></a>
</h4>
</div>
<div class="section level4">
<h4 id="example-pipeline">Example Pipeline:<a class="anchor" aria-label="anchor" href="#example-pipeline"></a>
</h4>
<p>These steps will take the unprocessed data set that we provide on
GitHub and sort and filter it in several ways. Depending on your
individual situation, you may want to only use some of these functions.
We will run them sequentially so that you have example uses of each. The
code snippets below will each be followed by descriptions. You can copy
them into your own file or follow along by running the
<code>PipelineMain.R</code> file.</p>
<p>For actually running this code, it is recommended that you have at
least four CPU cores and 16 GB of memory (RAM).</p>
<hr>
<div class="section level5">
<h5 id="step-1-combinedpar-function-to-calculate-combined-distances-and-t-sne">Step 1: CombinedPar Function to Calculate Combined Distances and
t-SNE<a class="anchor" aria-label="anchor" href="#step-1-combinedpar-function-to-calculate-combined-distances-and-t-sne"></a>
</h5>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">combined_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CombinedPar.html">CombinedPar</a></span><span class="op">(</span><span class="va">allptmtable.df</span>, <span class="va">allptmtable</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Combined data:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">combined_data</span><span class="op">)</span></span></code></pre></div>
<p>The CombinedPar function is designed to analyze your data by
calculating two types of distances (Spearman Dissimilarity and Euclidean
Distance) simultaneously. By utilizing separate CPU cores, this function
helps reduce processing time, making your analysis more efficient. Here,
allptmtable.df is your data frame containing the mass spectrometry data,
while allptmtable refers to the labels or additional information
relevant to your data. The result, combined_data, contains the processed
output that will be used in the next steps. Printing the result helps
you verify that the function has run correctly.</p>
</div>
<div class="section level5">
<h5 id="step-2-makeclusterlist">Step 2: MakeClusterList<a class="anchor" aria-label="anchor" href="#step-2-makeclusterlist"></a>
</h5>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cluster_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MakeClusterList.html">MakeClusterList</a></span><span class="op">(</span><span class="va">combined_data</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Cluster list:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">cluster_list</span><span class="op">)</span></span></code></pre></div>
<p>After obtaining the combined data from the previous step, the
MakeClusterList function is employed to identify clusters within your
dataset. Clustering is an important step in data analysis, allowing you
to group similar observations (in this case, genes) based on their
characteristics. This helps in understanding relationships in the data.
The output, cluster_list, will show which genes are grouped together,
enabling you to see how they relate to each other visually in the next
steps. Important Note: Avoid altering the output filesâ€™ data types, as
this can affect subsequent analyses.</p>
</div>
<div class="section level5">
<h5 id="step-3-findcommoncluster">Step 3: FindCommonCluster<a class="anchor" aria-label="anchor" href="#step-3-findcommoncluster"></a>
</h5>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">common_clusters</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/FindCommonCluster.html">FindCommonCluster</a></span><span class="op">(</span><span class="va">cluster_list</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Common clusters:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">common_clusters</span><span class="op">)</span></span></code></pre></div>
<p>This step uses the output from the MakeClusterList function to find
common clusters among your data. The FindCommonCluster function analyzes
the cluster list and generates a visual graph that represents the
relationships among the clusters. This graph is particularly useful for
visualizing how different gene clusters overlap, providing insights into
biological similarities.</p>
</div>
<div class="section level5">
<h5 id="step-4-generateandconstructallptmsnetwork">Step 4: GenerateAndConstructAllptmsNetwork<a class="anchor" aria-label="anchor" href="#step-4-generateandconstructallptmsnetwork"></a>
</h5>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">allptms_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/GenerateAndConstructAllptmsNetwork.html">GenerateAndConstructAllptmsNetwork</a></span><span class="op">(</span><span class="va">common_clusters</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"All PTMs network:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">allptms_network</span><span class="op">)</span></span></code></pre></div>
<p>In this step, the GenerateAndConstructAllptmsNetwork function takes
the common clusters you identified in the previous step to create a
network of Post-Translational Modifications (PTMs). PTMs are chemical
modifications that occur after a protein is produced, and understanding
these modifications is crucial for many biological processes. The
function merges the cluster data into a single comprehensive data frame,
preparing it for further analysis. This step is essential for connecting
the dots between different protein modifications.</p>
</div>
<div class="section level5">
<h5 id="step-5-bindmatrices">Step 5: BindMatrices<a class="anchor" aria-label="anchor" href="#step-5-bindmatrices"></a>
</h5>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bound_matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/BindMatrices.html">BindMatrices</a></span><span class="op">(</span><span class="va">allptms_network</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Bound matrices:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">bound_matrices</span><span class="op">)</span></span></code></pre></div>
<p>The BindMatrices function aligns the adjacency matrix (which
represents the relationships between different entities) with the
correlation matrix (which indicates how closely related different
observations are). By setting diagonal connections to NA, this function
helps clean up the data and ensures that only relevant relationships are
analyzed.</p>
</div>
<div class="section level5">
<h5 id="step-6-correlationnetwork">Step 6: CorrelationNetwork<a class="anchor" aria-label="anchor" href="#step-6-correlationnetwork"></a>
</h5>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">correlation_network</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CorrelationNetwork.html">CorrelationNetwork</a></span><span class="op">(</span><span class="va">bound_matrices</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Correlation network:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">correlation_network</span><span class="op">)</span></span></code></pre></div>
<p>Finally, the CorrelationNetwork function takes the bound matrices and
transforms them into an igraph object. This object represents a network
where nodes correspond to genes or proteins, and edges represent
relationships between them. Analyzing this correlation network allows
you to understand the complex interactions between different proteins in
your dataset, offering insights into their functional relationships.</p>
</div>
<div class="section level5">
<h5 id="step-7-purge-zeros">Step 7: Purge Zeros<a class="anchor" aria-label="anchor" href="#step-7-purge-zeros"></a>
</h5>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">zero_na_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/zero.to.NA.html">zero.to.NA</a></span><span class="op">(</span><span class="va">correlation_network</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Data with zeroes replaced by NA:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">zero_na_data</span><span class="op">)</span></span></code></pre></div>
<p>This function, which is smaller than most of ours, is just turning
every zero in the given data set to an NA value. This is so that later
on these missing numbers to not affect our workflow.</p>
</div>
<div class="section level5">
<h5 id="step-8-process-ptm-data">Step 8: Process PTM Data<a class="anchor" aria-label="anchor" href="#step-8-process-ptm-data"></a>
</h5>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">processed_data_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/process_ptms_data.html">process_ptms_data</a></span><span class="op">(</span><span class="va">eu.sp.sed.allptms</span>, <span class="va">sed.allptms.peps</span>, <span class="va">cccn_matrix</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Processed PTM data:"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">processed_data_path</span><span class="op">)</span></span></code></pre></div>
<p>Once again we run this function in the same manner as the others.
This function has more steps than most of the others. It creates an
adjacency matrix based on the Euclidean, Spearman, and combined data
sets, and sorts them based on their values. Then, it checks the data set
and adds correlation as edge values in the adjacency matrix.</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Mckayl Bailey.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer>
</div>





  </body>
</html>
